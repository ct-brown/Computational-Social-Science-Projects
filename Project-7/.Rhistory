ggtitle("Uninsured Rates in U.S. States in 2014") +
xlab("State") +
ylab("Uninsured Population") +
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))
# States that adopted on January 1, 2014
adopted <- medicaid_expansion %>%
filter(year == 2008 & Date_Adopted == "2014-01-01")
adopted <- unique(adopted$State)
adopted <- adopted[-13] # remove Massachusetts
medicaid_expansion %>%
subset(State %in% adopted) %>%
ggplot( aes(x = year,
y = uninsured_rate,
color = State)) +
geom_line() +
geom_vline(xintercept = 2014,
linetype = "dashed",
color = "black") +
theme_minimal()
# States that have not adopted
notAdopted <- medicaid_expansion %>%
filter(year == 2008 & is.na(Date_Adopted))
notAdopted <- unique(notAdopted$State)
medicaid_expansion %>%
subset(State %in% notAdopted) %>%
ggplot( aes(x = year,
y = uninsured_rate,
color = State)) +
geom_line() +
geom_vline(xintercept = 2014,
linetype = "dashed",
color = "black") +
theme_minimal()
# Parallel Trends plot
## I tried all of the states that didn't adopt, but none of them had similar downward slopes to California as did Georgia and Florida. I ultimately chose Florida because it looked most similar, though its far from perfect.
medicaid_expansion %>%
filter(State == "Florida" | State == "California") %>%
ggplot( aes(x = year,
y = uninsured_rate,
color = State)) +
geom_vline(xintercept = 2014,
linetype = "dashed",
color = "black") +
geom_line() +
theme_minimal()
# Difference-in-Differences estimation - California and Florida
# create a dataset for California and Florida
st <-
medicaid_expansion %>%
filter(State %in% c("California", "Florida")) %>%
filter(year >= 2014 & year <= 2015)
# pre-treatment difference
# ----------
pre_diff <-
st %>%
filter(year == 2014) %>%
select(State,
uninsured_rate) %>%
pivot_wider(names_from = State,
values_from = uninsured_rate) %>%
summarise(California - Florida)
# post-treatment difference
# ----------
post_diff <-
st %>%
filter(year == 2015) %>%
select(State,
uninsured_rate) %>%
pivot_wider(names_from = State,
values_from = uninsured_rate) %>%
summarise(California - Florida)
# diff-in-diffs
# ----------
diff_in_diffs <- post_diff - pre_diff
diff_in_diffs
View(medicaid_expansion)
colnames(medicaid_expansion)
# synthetic control
# ---------
syn <-
augsynth(uninsured_rate ~ treatment,
State,
year,
penn,
progfunc = "None",
scm = T)
# create a treatment indicator
# ----------
penn <- medicaid_expansion %>%
mutate(treatment = case_when(State == "Pennsylvania" & year >= 2015 ~ 1,
TRUE ~ 0))
View(penn)
# synthetic control
# ---------
syn <-
augsynth(uninsured_rate ~ treatment,
State,
year,
penn,
progfunc = "None",
scm = T)
# summary
summary(syn)
# plot
plot(syn)
# summary
summary(syn)
# augmented synthetic control
synRidge <-
augsynth(uninsured_rate ~ treatment,
State,
year,
penn,
progfunc = "ridge",
scm = T)
# summary
summary(synRidge)
# plot
plot(synRidge)
# For synthetic
data.frame(syn$weights) %>%
tibble::rownames_to_column('State') %>%
ggplot() +
geom_bar(aes(x = State,
y = syn.weights),
stat = 'identity') +
coord_flip() +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
ggtitle('Synthetic Control Weights') +
xlab('State') +
ylab('Weight')
# For augmented synthetic
data.frame(synRidge$weights) %>%
tibble::rownames_to_column('State') %>%
ggplot() +
geom_bar(aes(x = State, y = synRidge.weights),
stat = 'identity') +
coord_flip() +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
ggtitle('Synthetic Control Weights') +
xlab('State') +
ylab('Weight')
# For synthetic
data.frame(syn$weights) %>%
tibble::rownames_to_column('State') %>%
ggplot() +
geom_bar(aes(x = State,
y = syn.weights),
stat = 'identity') +
coord_flip() +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
ggtitle('Synthetic Control Weights') +
xlab('State') +
ylab('Weight')
# barplots of weights
# For synthetic
data.frame(syn$weights) %>%
tibble::rownames_to_column('State') %>%
ggplot() +
geom_bar(aes(x = State,
y = syn.weights),
stat = 'identity') +
coord_flip() +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
ggtitle('Synthetic Control Weights') +
xlab('State') +
ylab('Weight')
# For augmented synthetic
data.frame(synRidge$weights) %>%
tibble::rownames_to_column('State') %>%
ggplot() +
geom_bar(aes(x = State, y = synRidge.weights),
stat = 'identity') +
coord_flip() +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
ggtitle('Synthetic Control Weights') +
xlab('State') +
ylab('Weight')
# barplots of weights
# For synthetic
data.frame(syn$weights) %>%
tibble::rownames_to_column('State') %>%
ggplot() +
geom_bar(aes(x = State,
y = syn.weights),
stat = 'identity') +
coord_flip() +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
ggtitle('Synthetic Control Weights') +
xlab('State') +
ylab('Weight')
# For augmented synthetic
data.frame(synRidge$weights) %>%
tibble::rownames_to_column('State') %>%
ggplot() +
geom_bar(aes(x = State, y = synRidge.weights),
stat = 'identity') +
coord_flip() +
theme_fivethirtyeight() +
theme(axis.title = element_text()) +
ggtitle('Augmented Synthetic Control Weights') +
xlab('State') +
ylab('Weight')
colnames(medicaid_expansion)
table(medicaid_expansion$year)
# with default nu
# ---------
synMulti <- multisynth(uninsured_rate ~ Date_Adopted,
State,
year,
medicaid_expansion,
n_leads = 6)
?multisynth
# need to remove missing data
uninsured_rate_miss <- uninsured_rate %>%
na.omit()
# need to remove missing data
medicaid_expansion_miss <- medicaid_expansion %>%
na.omit()
# with default nu
# ---------
synMulti <- multisynth(medicaid_expansion_miss ~ Date_Adopted,
State,
year,
medicaid_expansion,
n_leads = 6)
# create dataset
medicaid_expansion_multi <- medicaid_expansion %>%
mutate(Date_Adopted = ifelse(is.na(Date_Adopted),
Inf, Date_Adopted),
treatment = 1 * (year >= Date_Adopted))
colnames(medicaid_expansion)
# with default nu
# ---------
synMulti <- multisynth(uninsured_rate ~ treatment,
State,
year,
medicaid_expansion_multi,
n_leads = 6)
View(medicaid_expansion_multi)
# create dataset
medicaid_expansion_multi <- medicaid_expansion %>%
mutate(treatment = 1 * (year >= Date_Adopted))
View(medicaid_expansion_multi)
# create dataset
medicaid_expansion_multi <- medicaid_expansion %>%
mutate(Date_Adopted = ifelse(is.na(Date_Adopted),
Inf, Date_Adopted),
treatment = 1 * (year >= Date_Adopted))
View(medicaid_expansion)
# create dataset
medicaid_expansion_multi <- medicaid_expansion %>%
mutate(treatment = 1 * (year >= Date_Adopted))
colnames(medicaid_expansion)
# create dataset
medicaid_expansion_multi <- medicaid_expansion %>%
mutate(treatment = ifelse(year >= Date_Adopted, 1, 0))
View(medicaid_expansion_multi)
class(medicaid_expansion$Date_Adopted)
class(medicaid_expansion$year)
medicaid_expansion_multi <- medicaid_expansion
medicaid_expansion_multi$Date_Adopted_num <- as.numeric(format(medicaid_expansion_multi$Date_Adopted, "%Y"))
View(medicaid_expansion_multi)
medicaid_expansion_multi <- medicaid_expansion_multi %>%
mutate(treatment = ifelse(year >= Date_Adopted, 1, 0))
View(medicaid_expansion_multi)
medicaid_expansion_multi <- medicaid_expansion
medicaid_expansion_multi$Date_Adopted_num <- as.numeric(format(medicaid_expansion_multi$Date_Adopted, "%Y"))
medicaid_expansion_multi <- medicaid_expansion_multi %>%
mutate(treatment = ifelse(year >= Date_Adopted_num, 1, 0))
View(medicaid_expansion_multi)
# with default nu
# ---------
synMulti <- multisynth(uninsured_rate ~ treatment,
State,
year,
medicaid_expansion_multi,
n_leads = 6)
summary(ppool_syn)
summary(synMulti)
# multisynth model states
# create dataset
medicaid_expansion_multi <- medicaid_expansion
medicaid_expansion_multi$Date_Adopted_num <- as.numeric(format(medicaid_expansion_multi$Date_Adopted, "%Y"))
medicaid_expansion_multi <- medicaid_expansion_multi %>%
mutate(treatment = ifelse(year >= Date_Adopted_num, 1, 0))
# with default nu
# ---------
synMulti <- multisynth(uninsured_rate ~ treatment,
State,
year,
medicaid_expansion_multi,
n_leads = 6)
summary(synMulti)
synMulti_sum <- summary(synMulti)
# plot actual estimates not values of synthetic controls
# ---------
synMulti_sum$att %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = "bottom") +
ggtitle('Synthetic Controls for State Collective Bargaining') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate')
View(synMulti_sum)
View(synMulti_sum$att)
View(synMulti_sum$att)
# plot actual estimates not values of synthetic controls
# ---------
synMulti_sum$att %>%
filter(Level == "California" | "Texas" | "Florida") %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = "bottom") +
ggtitle('Synthetic Controls for State Collective Bargaining') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate')
# plot actual estimates not values of synthetic controls
# ---------
synMulti_sum$att %>%
filter(Level == c("California", "Texas","Florida")) %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = "bottom") +
ggtitle('Synthetic Controls for State Collective Bargaining') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate')
# plot actual estimates not values of synthetic controls
# ---------
synMulti_sum$att %>%
filter(Level ==  %in% c("California", "Texas","Florida")) %>%
# plot actual estimates not values of synthetic controls
# ---------
synMulti_sum$att %>%
filter(Level %in% c("California", "Texas","Florida")) %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = "bottom") +
ggtitle('Synthetic Controls for State Collective Bargaining') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate')
unique(synMulti_sum$att$Level)
# plot actual estimates not values of synthetic controls
# ---------
synMulti_sum$att %>%
filter(Level %in% c("California", "New York","Illinois")) %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = "bottom") +
ggtitle('Synthetic Controls for State Collective Bargaining') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate')
# plot
synMulti_sum$att %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = 'None') +
ggtitle('Synthetic Controls for All States with Policy Adoption') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate') +
facet_wrap(~Level)
synMulti_sum$att %>%
filter(Level %in% c("California", "New York","Illinois")) %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = "bottom") +
ggtitle('Synthetic Controls for California, New York, and Illinois') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate')
# multisynth model time cohorts
synMulti_cohort <- multisynth(uninsured_rate ~ treatment,
State,
year,
medicaid_expansion_multi,
n_leads = 6,
time_cohort = TRUE)
summary(synMulti_cohort)
synMulti_sum <- summary(synMulti_cohort)
# plot
synMulti_cohort$att %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = 'None') +
ggtitle('Synthetic Controls with Time Cohort for All States with Policy Adoption') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate') +
facet_wrap(~Level)
# multisynth model time cohorts
synMulti_cohort <- multisynth(uninsured_rate ~ treatment,
State,
year,
medicaid_expansion_multi,
n_leads = 6,
time_cohort = TRUE)
summary(synMulti_cohort)
synMulti_cohort_sum <- summary(synMulti_cohort)
# plot
synMulti_cohort_sum$att %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = 'None') +
ggtitle('Synthetic Controls with Time Cohort for All States with Policy Adoption') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate') +
facet_wrap(~Level)
synMulti_cohort_sum$att %>%
filter(Level %in% c("California", "New York","Illinois")) %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = "bottom") +
ggtitle('Synthetic Controls with Time Cohort for California, New York, and Illinois') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate')
# multisynth model states
# create dataset
medicaid_expansion_multi <- medicaid_expansion
medicaid_expansion_multi$Date_Adopted_num <- as.numeric(format(medicaid_expansion_multi$Date_Adopted, "%Y"))
medicaid_expansion_multi <- medicaid_expansion_multi %>%
mutate(treatment = ifelse(year >= Date_Adopted_num, 1, 0))
# staggered adoption synthetic control
synMulti <- multisynth(uninsured_rate ~ treatment,
State,
year,
medicaid_expansion_multi,
n_leads = 6)
summary(synMulti)
synMulti_sum <- summary(synMulti)
# plot
synMulti_sum$att %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = 'None') +
ggtitle('Synthetic Controls for All States with Policy Adoption') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate') +
facet_wrap(~Level)
synMulti_sum$att %>%
filter(Level %in% c("California", "New York","Illinois")) %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = "bottom") +
ggtitle('Synthetic Controls for California, New York, and Illinois') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate')
synMulti_sum$att %>%
filter(Level %in% c("California", "New York","Illinois", "Arkansas")) %>%
ggplot(aes(x = Time, y = Estimate, color = Level)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 0) +
theme_fivethirtyeight() +
theme(axis.title = element_text(),
legend.position = "bottom") +
ggtitle('Synthetic Controls for California, New York, and Illinois') +
xlab('Time') +
ylab('Expenditure on Pupil Estimate')
View(synMulti_sum)
View(synMulti_sum$att)
